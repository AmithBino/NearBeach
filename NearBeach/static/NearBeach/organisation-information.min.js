"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[4093],{5599:(o,e,t)=>{t.r(e),t.d(e,{default:()=>V});var i=t(6252),n=t(9963);const a={class:"card"},r={class:"card-body"},s=(0,i._)("h1",null,"Organisation Information",-1),l=(0,i._)("br",null,null,-1),d=["href"],u=(0,i._)("hr",null,null,-1),c={class:"row"},g=(0,i._)("div",{class:"col-md-4"},[(0,i._)("strong",null,"Please Note"),(0,i._)("p",{class:"text-instructions"}," Please only use generic information for both the website and email. Do not use any personal details - you can create contacts in the section below. ")],-1),m={class:"col-md-3"},h=["src"],p=(0,i._)("br",null,null,-1),_=(0,i.Uk)("Update Profile Picture"),f={class:"col-md-5"},M={class:"form-group"},v={for:"id_organisation_name"},w=(0,i.Uk)(" Organisation Name "),b=(0,i._)("br",null,null,-1),E={class:"form-group"},y={for:"id_organisation_website"},k=(0,i.Uk)(" Organisation Website "),U=(0,i._)("br",null,null,-1),$={class:"form-group"},I={for:"id_organisation_email"},P=(0,i.Uk)(" Organisation Email "),L=(0,i._)("br",null,null,-1),N={key:0},S={key:1,class:"row submit-row"},O={class:"col-md-12"};var T=t(9669),R=t.n(T),B=t(996),C=t(8765),q=t(4250),W=t(4028),D=t(2587),Z=t(212),A=t(3058),x=t(8416),F=t(106);const H={name:"OrganisationInformation",setup:()=>({v$:(0,W.ZP)()}),components:{NButton:B.Z,NUpload:C.Z,ValidationRendering:Z.Z},props:{organisationResults:{type:Array,default:()=>[]}},mixins:[A.Z,F.Z,x.Z],computed:{...(0,q.Se)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl",userLevel:"getUserLevel"})},data(){return{organisationNameModel:this.organisationResults[0].fields.organisation_name,organisationEmailModel:this.organisationResults[0].fields.organisation_email,organisationWebsiteModel:this.organisationResults[0].fields.organisation_website,profilePicture:""}},validations:{organisationNameModel:{required:D.C1,maxLength:(0,D.BS)(255)},organisationWebsiteModel:{required:D.C1,url:D.HQ},organisationEmailModel:{required:D.C1,email:D.Do}},methods:{setProfilePicture(){let o=this.organisationResults[0].fields.organisation_profile_picture;this.profilePicture=null!=o&&""!==o?`${this.rootUrl}private/${o}`:`${this.staticUrl}/NearBeach/images/placeholder/product_tour.svg`},updateOrganisation(){if(this.v$.$touch(),this.v$.$invalid)return void this.showValidationErrorModal();const o=new FormData;o.set("organisation_name",this.organisationNameModel),o.set("organisation_email",this.organisationEmailModel),o.set("organisation_website",this.organisationWebsiteModel),this.showLoadingModal("Organisation"),R().post(`${this.rootUrl}organisation_information/${this.organisationResults[0].pk}/save/`,o).then((o=>{this.closeLoadingModal()})).catch((o=>{this.showErrorModal(o,"organisation",this.organisationResults[0].pk)}))},updateProfilePicture(){R().post(`${this.rootUrl}organisation_information/${this.organisationResults[0].pk}/get_profile_picture/`,{}).then((o=>{this.profilePicture=o.data})).catch((()=>{this.profilePicture=`${this.staticUrl}/NearBeach/images/placeholder/product_tour.svg`}))}},mounted(){this.setProfilePicture()}},V=(0,t(3744).Z)(H,[["render",function(o,e,t,T,R,B){const C=(0,i.up)("n-button"),q=(0,i.up)("n-upload"),W=(0,i.up)("validation-rendering");return(0,i.wg)(),(0,i.iD)("div",a,[(0,i._)("div",r,[(0,i.kq)(" TITLE "),s,l,(0,i._)("a",{href:`${o.rootUrl}search/organisation/`},"Back to organisation search",8,d),u,(0,i.kq)(" FIELDS SECTION "),(0,i._)("div",c,[g,(0,i._)("div",m,[(0,i._)("img",{src:R.profilePicture,alt:"Profile Picture",class:"organisation-profile-image"},null,8,h),p,(0,i.kq)('<button class="btn btn-primary">Update Profile...</button>'),o.userLevel>1?((0,i.wg)(),(0,i.j4)(q,{key:0,action:`${o.rootUrl}organisation_information/${t.organisationResults[0].pk}/update_profile/`,headers:{"X-CSRFTOKEN":o.getToken("csrftoken")},data:{},onFinish:B.updateProfilePicture},{default:(0,i.w5)((()=>[(0,i.Wm)(C,null,{default:(0,i.w5)((()=>[_])),_:1})])),_:1},8,["action","headers","onFinish"])):(0,i.kq)("v-if",!0)]),(0,i._)("div",f,[(0,i.kq)(" ORGANISATION NAME "),(0,i._)("div",M,[(0,i._)("label",v,[w,(0,i.Wm)(W,{"error-list":T.v$.organisationNameModel.$errors},null,8,["error-list"])]),(0,i.wy)((0,i._)("input",{id:"id_organisation_name","onUpdate:modelValue":e[0]||(e[0]=o=>R.organisationNameModel=o),type:"text",class:"form-control"},null,512),[[n.vModelText,R.organisationNameModel]])]),b,(0,i.kq)(" ORGANISATION WEBSITE "),(0,i._)("div",E,[(0,i._)("label",y,[k,(0,i.Wm)(W,{"error-list":T.v$.organisationWebsiteModel.$errors},null,8,["error-list"])]),(0,i.wy)((0,i._)("input",{id:"id_organisation_website","onUpdate:modelValue":e[1]||(e[1]=o=>R.organisationWebsiteModel=o),type:"text",class:"form-control"},null,512),[[n.vModelText,R.organisationWebsiteModel]])]),U,(0,i.kq)(" ORGANISATION EMAIL "),(0,i._)("div",$,[(0,i._)("label",I,[P,(0,i.Wm)(W,{"error-list":T.v$.organisationWebsiteModel.$errors},null,8,["error-list"])]),(0,i.wy)((0,i._)("input",{id:"id_organisation_email","onUpdate:modelValue":e[2]||(e[2]=o=>R.organisationEmailModel=o),type:"text",class:"form-control"},null,512),[[n.vModelText,R.organisationEmailModel]])])])]),L,(0,i.kq)(" NEED TO APPLY PERMISSIONS "),(0,i.kq)(" Submit Button "),o.userLevel>1?((0,i.wg)(),(0,i.iD)("hr",N)):(0,i.kq)("v-if",!0),o.userLevel>1?((0,i.wg)(),(0,i.iD)("div",S,[(0,i._)("div",O,[(0,i._)("a",{href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:e[3]||(e[3]=(...o)=>B.updateOrganisation&&B.updateOrganisation(...o))},"Update Organisation")])])):(0,i.kq)("v-if",!0)])])}]])},212:(o,e,t)=>{t.d(e,{Z:()=>r});var i=t(6252),n=t(3577);const a={name:"ValidationRendering",props:{errorList:{type:Array,default:()=>[]}}},r=(0,t(3744).Z)(a,[["render",function(o,e,t,a,r,s){return(0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.errorList,(o=>((0,i.wg)(),(0,i.iD)("span",{class:"error",key:o.$uid},(0,n.toDisplayString)(o.$message),1)))),128)}]])},3058:(o,e,t)=>{t.d(e,{Z:()=>n});var i=t(5169);const n={methods:{showErrorModal(o,e,t){new i.u_(document.getElementById("loadingModal")).hide(),document.getElementById("errorModalContent").innerHTML=`<strong>HTML ISSUE:</strong> We could not save the new ${e}-${t}<hr>${o}`,new i.u_(document.getElementById("errorModal")).show()},showValidationErrorModal(){document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",new i.u_(document.getElementById("errorModal")).show()}}}},106:(o,e,t)=>{t.d(e,{Z:()=>i});const i={methods:{getToken(o){const e=new RegExp(`${o}=([^;]+)`).exec(document.cookie);return null!==e?encodeURIComponent(e[1]):null}}}},8416:(o,e,t)=>{t.d(e,{Z:()=>n});var i=t(5169);const n={methods:{closeLoadingModal(){const o=new i.u_(document.getElementById("loadingModal"));document.getElementById("loadingModalContent").innerHTML="UPDATED SUCCESSFULLY",setTimeout((()=>{o.hide()}),1e3)},showLoadingModal(o){new i.u_(document.getElementById("loadingModal")).show(),document.getElementById("loadingModalContent").innerHTML=`Updating your ${o} details`}}}}}]);