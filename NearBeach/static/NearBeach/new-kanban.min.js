"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[3949],{7309:(e,a,o)=>{o.r(a),o.d(a,{default:()=>A});var r=o(6252),t=o(9963);const s={class:"card"},l={class:"card-body"},n=(0,r._)("h1",null,"New Kanban",-1),i=(0,r._)("hr",null,null,-1),d={class:"row"},u=(0,r._)("div",{class:"col-md-4"},[(0,r._)("strong",null,"Please note"),(0,r._)("p",{class:"text-instructions"},"Board names must be unique.")],-1),p={class:"col-md-8"},c={class:"form-group"},m=(0,r.Uk)("Kanban Board Name "),h={key:0,class:"error"},g={key:1,class:"error"},y={key:2,class:"error"},b=(0,r._)("hr",null,null,-1),v={class:"row"},k=(0,r._)("div",{class:"col-md-4"},[(0,r._)("h2",null,"Columns & Levels"),(0,r._)("p",{class:"text-instructions"}," Drag the cards around to sort out the columns how you want them. ")],-1),_={class:"col-md-4"},M={class:"col-md-4"},N=(0,r._)("hr",null,null,-1),w=(0,r._)("hr",null,null,-1),B={class:"row submit-row"},f={class:"col-md-12"};var q=o(6672),K=o(3931),$=o(4028),P=o(2587),D=o(3058);const C=o(9669),R={name:"NewKanban",setup:()=>({v$:(0,$.ZP)()}),components:{GroupPermissions:K.Z,KanbanPropertyOrder:q.Z},props:{groupResults:{type:Array,default:()=>[]},rootUrl:{type:String,default:"/"},userGroupResults:{type:Array,default:()=>[]}},mixins:[D.Z],data:()=>({checkingKanbanBoardName:!1,columnModel:[{id:0,property:"Normal",title:"Backlog"},{id:1,property:"Blocked",title:"Blocked"},{id:2,property:"Normal",title:"In Progress"},{id:4,property:"Normal",title:"Review and QA"},{id:5,property:"Closed",title:"Completed"}],groupModel:[],kanbanBoardNameModel:"",levelModel:[{id:0,title:"Sprint 1"},{id:1,title:"Sprint 2"}],searchTimeout:"",uniqueKanbanBoardName:!0}),validations:{columnModel:{required:P.C1},groupModel:{required:P.C1},kanbanBoardNameModel:{required:P.C1},levelModel:{required:P.C1}},watch:{kanbanBoardNameModel(){this.checkingKanbanBoardName=!0,""!=this.searchTimeout&&clearTimeout(this.searchTimeout),void 0===this.kanbanBoardNameModel?this.searchTimeout=setTimeout(this.checkKanbanBoardName,500):this.kanbanBoardNameModel.length>=3&&(this.searchTimeout=setTimeout(this.checkKanbanBoardName,500,this.kanbanBoardNameModel,null))}},methods:{addNewKanban(){if(this.v$.$touch(),this.v$.$invalid||!this.uniqueKanbanBoardName||this.checkingKanbanBoardName)return void this.showValidationErrorModal();const e=new FormData;e.set("kanban_board_name",this.kanbanBoardNameModel),this.columnModel.forEach((a=>{e.append("column_title",a.title),e.append("column_property",a.property)})),this.levelModel.forEach((a=>{e.append("level_title",a.title)})),this.groupModel.forEach((a=>{e.append("group_list",a)})),C.post(`${this.rootUrl}new_kanban_save/`,e).then((e=>{window.location.href=e.data})).catch((e=>{}))},checkKanbanBoardName(){const e=new FormData;e.set("kanban_board_name",this.kanbanBoardNameModel),C.post(`${this.rootUrl}kanban_information/check_kanban_board_name/`,e).then((e=>{this.uniqueKanbanBoardName=0==e.data.length,this.checkingKanbanBoardName=!1})).catch((e=>{}))},updateGroupModel(e){this.groupModel=e},updatePropertyList(e){this[e.source]=e.data}}},A=(0,o(3744).Z)(R,[["render",function(e,a,o,q,K,$){const P=(0,r.up)("kanban-property-order"),D=(0,r.up)("group-permissions");return(0,r.wg)(),(0,r.iD)("div",s,[(0,r._)("div",l,[n,i,(0,r._)("div",d,[(0,r.kq)(" DESCRIPTION "),u,(0,r.kq)(" BOARD NAME "),(0,r._)("div",p,[(0,r._)("div",c,[(0,r._)("label",null,[m,!q.v$.kanbanBoardNameModel.required&&q.v$.kanbanBoardNameModel.$dirty?((0,r.wg)(),(0,r.iD)("span",h," Please suppy a title. ")):(0,r.kq)("v-if",!0),K.uniqueKanbanBoardName?(0,r.kq)("v-if",!0):((0,r.wg)(),(0,r.iD)("span",g," Please supply a unique name")),K.checkingKanbanBoardName?((0,r.wg)(),(0,r.iD)("span",y," Checking kanban name...")):(0,r.kq)("v-if",!0)]),(0,r.wy)((0,r._)("input",{type:"text",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=e=>K.kanbanBoardNameModel=e)},null,512),[[t.vModelText,K.kanbanBoardNameModel]])])])]),b,(0,r.kq)(" Properties for the drag and drop coloumns/levels "),(0,r._)("div",v,[k,(0,r._)("div",_,[(0,r.Wm)(P,{"property-name":"Column","property-list":K.columnModel,source:"columnModel","is-dirty":q.v$.columnModel.$dirty,onUpdate_property_list:a[1]||(a[1]=e=>$.updatePropertyList(e))},null,8,["property-list","is-dirty"])]),(0,r._)("div",M,[(0,r.Wm)(P,{"property-name":"Level","property-list":K.levelModel,source:"levelModel","is-dirty":q.v$.columnModel.$dirty,onUpdate_property_list:a[2]||(a[2]=e=>$.updatePropertyList(e))},null,8,["property-list","is-dirty"])])]),(0,r.kq)(" Group Permissions "),N,(0,r.Wm)(D,{"group-results":o.groupResults,destination:"kanban_board","user-group-results":o.userGroupResults,onUpdate_group_model:a[3]||(a[3]=e=>$.updateGroupModel(e)),"is-dirty":q.v$.groupModel.$dirty},null,8,["group-results","user-group-results","is-dirty"]),(0,r.kq)(" SAVE "),w,(0,r._)("div",B,[(0,r._)("div",f,[(0,r._)("button",{class:"btn btn-primary save-changes",onClick:a[4]||(a[4]=(...e)=>$.addNewKanban&&$.addNewKanban(...e))}," Add Kanban ")])])])])}]])},3931:(e,a,o)=>{o.d(a,{Z:()=>y});var r=o(6252),t=o(3577);const s={class:"row"},l={class:"col-md-4"},n=(0,r._)("h2",null,"Group Permissions",-1),i={class:"text-instructions"},d=(0,r._)("p",{class:"text-instructions"}," If you do not add one of your own group(s), you will only get readonly access. ",-1),u={class:"col-md-8"},p=(0,r.Uk)("Group List "),c={key:0,class:"error"};var m=o(4028),h=o(2587);const g={name:"GroupPermissions",setup:()=>({v$:(0,m.ZP)()}),components:{NSelect:o(9860).Z},props:{destination:{type:String,default:""},groupResults:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!0},userGroupResults:{type:Array,default:()=>[]}},watch:{groupModel(){this.$emit("update_group_model",this.groupModel)}},data:()=>({groupFixResults:[],groupModel:[]}),validations:{groupModel:{required:h.C1}},mounted(){this.groupFixResults=this.groupResults.map((e=>({value:e.pk,label:e.fields.group_name}))),this.groupModel=this.userGroupResults.map((e=>e.group_id))}},y=(0,o(3744).Z)(g,[["render",function(e,a,o,m,h,g){const y=(0,r.up)("n-select");return(0,r.wg)(),(0,r.iD)("div",s,[(0,r._)("div",l,[n,(0,r._)("p",i," Add or remove groups from this "+(0,t.toDisplayString)(o.destination)+". Adding a group will allow users from that group to access this "+(0,t.toDisplayString)(o.destination)+". ",1),d]),(0,r._)("div",u,[(0,r._)("label",null,[p,!m.v$.groupModel.required&&o.isDirty?((0,r.wg)(),(0,r.iD)("span",c," Please select at least one group.")):(0,r.kq)("v-if",!0)]),(0,r.Wm)(y,{options:h.groupFixResults,label:"group",value:h.groupModel,"onUpdate:value":a[0]||(a[0]=e=>h.groupModel=e),multiple:""},null,8,["options","value"])])])}]])}}]);